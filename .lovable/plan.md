

# Add Manual Order Creation Panel

## Overview
Add a slide-over panel (Sheet) to the admin orders page that allows creating orders manually for phone, walk-in, Messenger, and Instagram orders. The panel includes customer info, product search with size/stock selection, order totals, and payment options.

## Files to Create

### 1. `src/components/admin/CreateOrderPanel.tsx`
A Sheet component that slides in from the right, containing:

**Section 1 -- Order Source**: Select dropdown with Messenger, Instagram, Phone, Walk-in, Website options.

**Section 2 -- Customer Info**:
- Full Name (required)
- Phone (required, validated as BD number)
- Address (required)
- City/District (text input, matching existing checkout pattern)
- Order Notes (optional textarea)

**Section 3 -- Add Products**:
- Searchable product select (fetches active products with variants from database)
- After selecting a product: size buttons showing stock in brackets like "M (8)", disabled with strikethrough when stock is 0
- Quantity input (max = available stock)
- "Add to Order" button
- Added items table: Product | Size | Qty | Price | Total | Remove button
- Running totals: Subtotal, Delivery (editable, default 80), Discount (editable), Total

**Section 4 -- Payment**:
- Payment Method: COD / bKash / Nagad (select)
- Payment Status: Unpaid / Paid (select)

**Section 5 -- Submit**:
- "Create Order" button
- Inserts into `orders` table (order number auto-generated by existing trigger)
- Inserts into `order_items` for each item (stock auto-deducted by existing trigger)
- Shows toast with order number on success
- Closes panel and refreshes orders list

**Validation**: Name + phone required, at least 1 item required, inline error messages.

## Files to Edit

### 2. `src/pages/admin/AdminOrders.tsx`
- Import CreateOrderPanel
- Add `showCreatePanel` state
- Add "Add Order" button next to the "Orders" title
- Render `<CreateOrderPanel open={showCreatePanel} onClose={...} />`

## No Database Changes Needed
- The `orders` table already has `source`, `payment_method`, `payment_status` columns
- The `generate_order_number` trigger auto-creates order numbers
- The `decrement_stock_on_order` trigger handles stock deduction
- The `upsert_customer_on_order` trigger handles customer creation

## Technical Notes
- Products + variants fetched via `supabase.from("products").select("*, product_variants(*)").eq("is_active", true)`
- Uses existing `formatPrice` utility for currency display
- Sheet component from shadcn/ui for the slide-over
- After successful creation, invalidates `admin-orders-list` and `admin-order-counts` query keys

